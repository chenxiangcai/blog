(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["personalCenter"],{"21aa":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-card",{staticStyle:{"margin-bottom":"90px"}},[r("el-form",{ref:"personalForm",attrs:{model:e.personalForm,rules:e.personalFormRules}},[r("el-form-item",{attrs:{label:"头像"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-upload",{attrs:{limit:this.limit,action:e.upURL,"list-type":"picture-card","on-success":e.handleAvatarSuccess,"on-remove":e.handleRemove,"file-list":e.fileList}},[r("i",{staticClass:"el-icon-plus"})])],1),r("el-col",{attrs:{span:10}},[r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.personalForm.email,callback:function(t){e.$set(e.personalForm,"email",t)},expression:"personalForm.email"}})],1),r("el-form-item",{staticStyle:{"margin-top":"7px"},attrs:{label:"昵称",prop:"nickName"}},[r("el-input",{model:{value:e.personalForm.nickName,callback:function(t){e.$set(e.personalForm,"nickName",t)},expression:"personalForm.nickName"}})],1),r("el-button",{staticClass:"editP",attrs:{type:"primary"},on:{click:e.upUserInfo}},[e._v("修改")])],1)],1)],1)],1)],1)},n=[],o=(r("96cf"),r("1da1")),s=r("5530"),i=r("5880"),l=r("365c"),c={name:"UserDetail",computed:Object(s["a"])({},Object(i["mapState"])(["upURL","userInfo","host"])),data:function(){var e=function(e,t,r){var a=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/;if(!t)return r(new Error("邮箱不能为空"));setTimeout((function(){a.test(t)?r():r(new Error("请输入正确的邮箱格式"))}),100)};return{limit:2,fileList:[],personalForm:{avatar:"",email:"",nickName:"",role:"",status:""},personalFormRules:{nickName:[{required:!0,message:"请输入用户昵称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 20 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:e,trigger:"blur"}]}}},mounted:function(){this.personalForm.email=this.userInfo.userInfo.email,this.personalForm.nickName=this.userInfo.userInfo.nickName,this.fileList.push({url:"".concat(this.host)+this.userInfo.userInfo.avatar})},methods:Object(s["a"])(Object(s["a"])({},Object(i["mapMutations"])(["USERINFO"])),{},{handleAvatarSuccess:function(e){this.fileList.shift(),this.fileList.push({url:"".concat(this.host)+e[0].file}),this.personalForm.avatar=e[0].file},handleRemove:function(){this.personalForm.avatar=""},upUserInfo:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.personalForm.avatar||(e.personalForm.avatar=e.userInfo.userInfo.avatar),e.personalForm.role=e.userInfo.userInfo.role,e.personalForm.status=e.userInfo.userInfo.status,t.next=5,e.$http.put(l["g"]+"/".concat(e.userInfo.userInfo._id),e.personalForm);case 5:if(r=t.sent,a=r.data,1===a.nModified){t.next=9;break}return t.abrupt("return",e.$message.error("修改用户信息失败"));case 9:e.$message.success("更新用户信息成功"),e.USERINFO(e.personalForm);case 11:case"end":return t.stop()}}),t)})))()}})},u=c,m=(r("239f"),r("2877")),p=Object(m["a"])(u,a,n,!1,null,"62a19a02",null);t["default"]=p.exports},"239f":function(e,t,r){"use strict";var a=r("e205"),n=r.n(a);n.a},2779:function(e,t,r){"use strict";var a=r("3afc"),n=r.n(a);n.a},"3afc":function(e,t,r){},6895:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-card",{staticStyle:{"margin-bottom":"245px"}},[r("el-form",{ref:"pwdForm",attrs:{model:e.pwdForm,"status-icon":"",rules:e.pwdRules,"label-width":"77px"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"旧密码",prop:"lastPwd"}},[r("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.pwdForm.lastPwd,callback:function(t){e.$set(e.pwdForm,"lastPwd",t)},expression:"pwdForm.lastPwd"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"新密码",prop:"newPwd"}},[r("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.pwdForm.newPwd,callback:function(t){e.$set(e.pwdForm,"newPwd",t)},expression:"pwdForm.newPwd"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"确认密码",prop:"confirmPwd"}},[r("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.pwdForm.confirmPwd,callback:function(t){e.$set(e.pwdForm,"confirmPwd",t)},expression:"pwdForm.confirmPwd"}})],1),r("el-button",{staticClass:"editP",attrs:{type:"primary"},on:{click:e.upToChangePwd}},[e._v("修改")])],1)],1)],1)],1)},n=[],o=(r("96cf"),r("1da1")),s=r("365c"),i={name:"EditPwd",data:function(){var e=this,t=function(t,r,a){""===r?a(new Error("请输入密码")):(""!==e.pwdForm.confirmPwd&&e.$refs.pwdForm.validateField("confirmPwd"),a())},r=function(t,r,a){""===r?a(new Error("请再次输入密码")):r!==e.pwdForm.newPwd?a(new Error("两次输入密码不一致!")):a()};return{pwdForm:{newPwd:"",confirmPwd:"",lastPwd:""},pwdRules:{lastPwd:[{validator:t,trigger:"blur"}],newPwd:[{validator:t,trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],confirmPwd:[{validator:r,trigger:"change"}]}}},methods:{upToChangePwd:function(){var e=this;this.$refs.pwdForm.validate(function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(r){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.$http.put(s["t"],e.pwdForm);case 4:if(a=t.sent,n=a.data,"密码修改成功"===n.message){t.next=8;break}return t.abrupt("return",e.$message.error(n.message));case 8:e.$message.success(n.message),e.logout();case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},logout:function(){window.sessionStorage.clear(),this.$router.push({name:"login"})}}},l=i,c=(r("aba9"),r("2877")),u=Object(c["a"])(l,a,n,!1,null,"71912459",null);t["default"]=u.exports},"9b10":function(e,t,r){},aba9:function(e,t,r){"use strict";var a=r("9b10"),n=r.n(a);n.a},e205:function(e,t,r){},f566:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-container",[r("el-header",[r("el-menu",{staticStyle:{margin:"0 auto",width:"1400px"},attrs:{"default-active":e.activePath,mode:"horizontal","background-color":"#4CA1AF","text-color":"#fff","active-text-color":"#ffd04b"},on:{select:e.handleSelect}},[r("el-menu-item",{staticStyle:{"margin-left":"3%"},on:{click:e.toHome}},[r("i",{staticClass:"el-icon-back",staticStyle:{color:"#fff"}})]),r("el-menu-item",{staticStyle:{"margin-left":"3%"},attrs:{index:"/personal"},on:{click:e.toPersonal}},[e._v("个人信息")]),r("el-menu-item",{attrs:{index:"/pwd"},on:{click:e.toEditPwd}},[e._v("修改密码")])],1)],1),r("el-main",[r("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[r("router-view")],1)],1),r("copyrights")],1)},n=[],o=r("5530"),s=r("6152"),i=r("5d2d"),l=r("5880"),c={name:"user",components:{Copyrights:s["a"]},data:function(){return{activePath:""}},computed:Object(o["a"])({},Object(l["mapState"])(["settings","host"])),created:function(){Object(i["b"])("activePath","/personal"),this.activePath=Object(i["a"])("activePath")},methods:{handleSelect:function(e){Object(i["b"])("activePath",e)},toHome:function(){this.$router.push({name:"home"})},toPersonal:function(){this.$router.push({name:"center"})},toEditPwd:function(){this.$router.push({name:"editpwd"})}}},u=c,m=(r("2779"),r("2877")),p=Object(m["a"])(u,a,n,!1,null,"f1e0f208",null);t["default"]=p.exports}}]);
//# sourceMappingURL=personalCenter.748cc912.js.map